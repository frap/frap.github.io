
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>CCIE ATM/POS Study Notes - Andrés Gasson.</title>
  <meta name="author" content="Andrés Gasson">

  
  <meta name="description" content="Layer2 (ATM,POS,SDH,SONET) Documentation Notes for CCIE study">
  <meta name="keywords" content="CCIE, SONET, SDH, POS, ATM, Cisco, CCIE Study notes">

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://www.red-elvis.net/2008/12/15/layer2">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="http://feeds.feedburner.com/RamblingsOfAGeekyElvis" rel="alternate" title="Andrés Gasson." type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/lib/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link rel="stylesheet" type="text/css" href="//cdn.moot.it/1/moot.css" />
<script src="//cdn.moot.it/1/moot.min.js"></script>

  

</head>

<body   >
  <header role="banner"><hgroup>
</hgroup>

</header>
  <!-- <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="http://feeds.feedburner.com/RamblingsOfAGeekyElvis" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://www.duckduckgo.com/" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:www.red-elvis.net" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav> -->
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">CCIE ATM/POS Study Notes</h1>
    
    
      <p class="meta">
        








  


<time datetime="2008-12-15T09:15:00+13:00" pubdate data-updated="true">Dec 15<span>th</span>, 2008</time>
        
      </p>
    
  </header>


<div class="entry-content"><h2>ATM</h2>

<p>The 5 byte ATM UNI and NNI cell headers are shown below:</p>

<p>![ATM UNI][1]</p>

<p>The NNI cell header format, depicted below, includes the same fields except that the GFC space is displaced by a larger VPI space, occupying 12 bits and making more VPIs available for NNIs.</p>

<p><img src="./img/ATM-NNI.tiff" alt="ATM NNI" /></p>

<p>The following are descriptions of the cell header components:</p>

<ul>
<li>GFC – Generic Flow Control. 4 bits</li>
<li>VPI – Virtual Path ID. 8 bits (255 values) for UNI. 12 bits (4095 values) for NNI</li>
<li>VCI – Virtual Circuit ID. 16 bits (65535 values).</li>
<li>PT – Payload Type. The second and third bits indicate Maintenance or Management flow data for Control traffic

<ul>
<li> First Bit – Control Data or User Data</li>
<li> Second Bit – Congestion notification for User Data</li>
<li> Third Bit – End of AAL5 frame for User Data</li>
</ul>
</li>
<li>CLP – Cell Loss Priority. Indicates whether or not a cell should be discarded when encountering congestion</li>
<li>HEC – Header Error Correction. Contains an 8 bit CRC for the header.</li>
</ul>


<p>The ATM architecture is based on a logical model, called the ATM reference model, that describes the functionality it supports. In the ATM reference model (below), the ATM physical layer corresponds approximately to the physical layer of the OSI reference model, and the ATM layer and ATM adaptation layer (AAL) are roughly analogous to the data link layer of the OSI reference model.</p>

<p><img src="./img/ATM-Reference-model.tiff" alt="ATM Reference Model" /></p>

<!-- more -->


<h3>Traffic Contracts &amp; Service Categories</h3>

<p>ATM connections are further characterized by a traffic contract, which specifies a service category along with traffic and quality of service (QoS) parameters. Five service categories are currently defined, each with a purpose and its own interpretation of applicable parameters</p>

<h4>Traffic Contract</h4>

<p>At the time a connection is set up, a traffic contract is entered, guaranteeing that the requested service requirements will be met. These requirements are traffic parameters and QoS parameters:</p>

<ul>
<li>Traffic parameters—generally pertain to bandwidth requirements and include the following:

<ul>
<li>Peak cell rate (PCR)</li>
<li>Sustainable cell rate (SCR)</li>
<li>Burst tolerance, conveyed through the maximum burst size (MBS)</li>
<li>Cell delay variation tolerance (CDVT)</li>
<li>Minimum cell rate (MCR)</li>
</ul>
</li>
<li>QoS parameters—generally pertain to cell delay and loss requirements and include the following:

<ul>
<li>Maximum cell transfer delay (MCTD)</li>
<li>Cell loss ratio (CLR)</li>
<li>Peak-to-peak cell delay variation (ppCDV)</li>
</ul>
</li>
</ul>


<h4>Service Categories</h4>

<p>ATM provides five standard service categories that meet these requirements by defining individual performance characteristics, ranging from best effort (Unspecified Bit Rate [UBR]) to highly controlled, full-time bandwidth (Constant Bit Rate [CBR]). Below lists each service category defined by the ATM Forum along with its applicable traffic parameters and QoS characteristics.</p>

<p><img src="./img/ATM-Service-Categories.tiff" alt="ATM Service Categories" /></p>

<p>The characteristics and uses of each service category are summarized as follows:</p>

<ul>
<li>CBR service provides constant bandwidth with a fixed timing relationship, which requires clocking synchronization. Because CBR traffic reserves a fixed amount of bandwidth, some trunk bandwidth might go unused. CBR is typically used for circuit emulation services to carry real-time voice and video.</li>
<li>VBR-RT service provides only a partial bandwidth guarantee. Like CBR, however, some bandwidth might still go unused. Typical applications include packetized voice and video, and interactive multimedia.</li>
<li>VBR-NRT service provides a partial bandwidth guarantee, but with a higher cell delay than VBR-RT. This service category is suitable for bursty applications, such as file transfers.</li>
<li>ABR provides a best effort service, in which feedback flow control within the network is used to increase bandwidth when no congestion is present, maximizing the use of the network.</li>
<li>UBR service provides no bandwidth guarantee, but attempts to fill bandwidth gaps with bursty data. UBR is well suited for LAN protocols, such as LAN emulation. An additional category, UBR+, is a Cisco extension to UBR that provides for a nonzero MCR in the traffic contract.</li>
</ul>


<h3>Service-dependent ATM Adaption layers</h3>

<p>For ATM to support multiple classes of service with different traffic characteristics and requirements, it is necessary to adapt the different classes to the ATM layer. This adaptation is performed by the service-dependent AAL.
The service-dependent AAL provides a set of rules for segmentation and reassembly of packets. The sender segments the packet and builds a set of cells for transmission, while the receiver verifies the integrity of the packet and reassembles the cells back into packets—all according to a set of rules designed to satisfy a particular type of service. Table 1-2 lists the four AAL types recommended by the ITU-T, along with the service categories commonly supported by each and the corresponding connection mode.</p>

<p><img src="./img/ATM-Service-Dependent-AAL.tiff" alt="ATM Service Dependent AAL" /></p>

<h3>Autconfigured ATM Addressing Scheme</h3>

<p>During initial startup, the ATM switch router generates an ATM address using the following defaults (see Figure below):</p>

<ul>
<li>AFI=47—indicates an address of type ICD</li>
<li>ICD=0091(Cisco-specific)</li>
<li>Cisco-specific address type (part of HO-DSP)=81000000</li>
<li>Cisco switch ID=MAC format address</li>
<li>ESI=MAC address repeated</li>
<li>Selector equals 0—1 byte</li>
</ul>


<p><img src="./img/ATM-Address.tiff" alt="ATM Addressing" /></p>

<p>The autoconfigured address mechanism provides a default ATM address for the unconfigured switch. This default address is used by the following protocols:</p>

<ul>
<li>The Integrated Local Management Interface (ILMI)—a protocol and part of the UNI specifications that facilitates sharing of management information across the UNI. ILMI uses the first 13 bytes of this address to hand to end systems for the generation of ESI addresses. See the &ldquo;ILMI Use of the ATM Address&rdquo; section.</li>
<li>Private Network-Network Interface (PNNI)—a dynamic routing protocol for ATM networks. PNNI uses the 13-byte prefix to establish itself as a node in a single-level PNNI routing domain and the first 7 bytes to construct the default peer group identifier. For a complete discussion, see &ldquo;ATM Routing with IISP and PNNI.&rdquo;
The general structure of NSAP format ATM addresses, shown in Figure 2-2, is as follows:</li>
<li>An initial domain part (IDP)—consists of two elements: an authority and format identifier (AFI) that identifies the type and format of the second element, the initial domain identifier (IDI). The IDI identifies the address allocation and administration authority.</li>
<li>A domain specific part (DSP)—contains the actual routing information in three elements: a high-order domain specific part (HO-DSP), an end system identifier (ESI), which is the MAC address, and NSAP selector (SEL) field, used to identify LAN emulation (LANE) components.</li>
</ul>


<p><img src="./img/ATM-NSAP-address.tiff" alt="ATM NSAP Addresses" /></p>

<ul>
<li>Private ATM address formats are of three types that differ by the nature of their AFI and IDI (see Figure 2-2):</li>
<li>DCC format (AFI=39)—the IDI is a Data Country Code (DCC). DCC addresses are administered by the ISO national member body in each country.</li>
<li>ICD format (AFI=47)—the IDI is an International Code Designator (ICD). ICD address codes identify particular international organizations and are allocated by the British Standards Institute.</li>
<li>NSAP encoded E.164 format (AFI=45)—the IDI is an E.164 number.</li>
</ul>


<h2>POS</h2>

<p>SONET Layers:</p>

<ul>
<li>Section</li>
<li>Line</li>
<li>Path</li>
</ul>


<p>Each Synchronous Transport Signal-1 (STS-1) consists of 810 bytes, which includes 27 bytes for the Transport Overhead (TOH) and 783 bytes for the Synchronous Payload Envelope (SPE).
The Section OverHead (SOH) and Line OverHead (LOH) form the Transport OverHead (TOH), while the POH and actual payload (referred to as Payload Capacity in Figure 1) form the Synchronous Payload Envelope (SPE).</p>

<p><img src="./img/POS-layers.tiff" alt="POS layers" /></p>

<p>Each layer adds some number of overhead bytes to the SONET frame. This table illustrates the overhead bytes of the SONET frame:</p>

<p><img src="./img/POS-overhead.tiff" alt="POS overhead" /></p>

<h3>C2 byte</h3>

<p>The SONET standard defines the C2 byte as the path signal label. The purpose of this byte is to communicate the payload type that the SONET Framing OverHead (FOH) encapsulates. The C2 byte functions similar to Ethertype and Logical Link Control (LLC)/Subnetwork Access Protocol (SNAP) header fields on an Ethernet network. The C2 byte allows a single interface to transport multiple payload types simultaneously.
This table lists common values for the C2 byte:</p>

<p><img src="./img/POS-C2byte.tiff" alt="C2 byte" /></p>

<h4>C2 byte and scrambling</h4>

<p>With reference to the table, POS interfaces use a value of 0x16 or 0xCF in the C2 byte depending on whether ATM-style scrambling is enabled. RFC 2615  , which defines PPP over SONET/SDH, mandates the use of these values based on the scrambling setting. This is how the RFC defines the C2 byte values:
&ldquo;The value of 22 (16 hex) is used to indicate PPP with X<sup>43</sup>+ 1 scrambling <a href="./img/ATM-Service-Categories.tiff">4</a>. For compatibility with RFC 1619 (STS-3c-SPE/VC-4 only), if scrambling has been configured to be off, then the value 207 (CF hex) is used for the Path Signal Label to indicate PPP without scrambling.&rdquo;
In other words:</p>

<ul>
<li>If scrambling is enabled, POS interfaces use a C2 value of 0x16.</li>
<li>If scrambling is disabled, POS interfaces use a C2 value of 0xCF.</li>
</ul>


<p>Most POS interfaces that use a default C2 value of 0x16 (22 decimal) insert the pos flag c2 22 command in the configuration, although this line does not appear in the running configuration because 0x16 is the default value. Use the pos flag c2 command to change the default value.</p>

<pre><code>7507-3a(config-if)#pos flag c2 ?
   &lt;0-255&gt;  byte value
</code></pre>

<p>Use the show running-config command to confirm your change. The show controller pos command outputs the receive value. Therefore, a change in the value on the local end does not change the value in the show controller command output.</p>

<pre><code>7507-3a#show controller pos 0/0/0
COAPS = 13       PSBF = 3
 State: PSBF_state = False
 Rx(K1/K2): 00/00  Tx(K1/K2): 00/00
 S1S0 = 00, C2 = CF
Understand Scrambling and Two Levels
Scrambling randomizes the pattern of 1s and 0s carried in the SONET frame in order to prevent continuous strings of all 1s or all 0s. This process also meets the needs of physical layer protocols that rely on sufficient transitions between 1s and 0s to maintain clocking.
POS interfaces support two levels of scrambling, which are explained here:
</code></pre>

<ul>
<li>The International Telecommunications Union (ITU-T) GR-253 standard defines a 1 + x6 + x7 algorithm that scrambles all but the first row of the SOH. You cannot disable this scrambler, which is adequate when the SONET frames carry phone calls in the payload.</li>
<li>The ITU-T I.432 standard defines what POS interfaces refer to as ATM-style scrambling. This scrambler uses a polynomial of 1 + x43, and is a self-synchronous scrambler. This means that the sender does not need to send any state to the receiver.</li>
</ul>


<p>As a relatively simple string of 0s can lead to a line flap and interrupt service, Cisco recommends that you enable ATM-style scrambling in all configurations, including dark fiber. On some line cards on the Gigabit Switch Router (GSR), for example, the OC-192 POS, the scrambling command has been removed from the command-line interface, and you must enable this command. Scrambling remains OFF by default on lower-speed POS line cards for backward compatibility.</p>

<p>Scrambling is performed in hardware, and poses no performance penalty on the router. Scrambling occurs directly in the framer Application-Specific Integrated Circuit (ASIC) on newer line cards like the GSR&rsquo;s 8/16xOC3 and 4xOC12, or in an adjacent ASIC on older line cards like the GSR&rsquo;s 4xOC3 or 1xOC12 POS.</p>

<p>Figure 2 shows the proper order of operation, and indicates when scrambling is performed during transmission.
<img src="./img/POS-order.tiff" alt="" /></p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Andrés Gasson</span></span>

      








  


<time datetime="2008-12-15T09:15:00+13:00" pubdate data-updated="true">Dec 15<span>th</span>, 2008</time>
      

<span class="categories">
  
    <a class='category' href='/categories/atm/'>ATM</a>, <a class='category' href='/categories/ccie/'>CCIE</a>, <a class='category' href='/categories/l2/'>L2</a>, <a class='category' href='/categories/pos/'>POS</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="http://www.red-elvis.net/2008/12/15/layer2/" data-via="agasson" data-counturl="http://www.red-elvis.net/2008/12/15/layer2/" >Tweet</a>
  
  
  <div class="g-plusone" data-size="medium"></div>
  
  
    <div class="fb-like" data-send="true" data-width="450" data-show-faces="false"></div>
  
</div>

    
    <p class="meta">
      
      
        <a class="basic-alignment right" href="/2008/12/17/ntp/" title="Next Post: NTP">NTP &raquo;</a>
      
    </p>
  </footer>
</article>

</div>

<aside class="sidebar">
  
    <section>
  <ul id="recent_posts">
      <li class="post">
      <a href="http://www.red-elvis.net" alt="Home"><img src="/images/Home.png"></a>
      <a href="http://www.red-elvis.net/archives/" alt="Archives"><img src="/images/Calendar.png"></a>
      <a href="mailto:" alt="E-Mail"><img src="/images/Envelope.png"></a>
      <a href="http://www.red-elvis.net/atom.xml" alt="subscribe feed"><img src="/images/rss_big.png"></a>
      </li>
  </ul>
</section>

<section>
	<span>
		<img src="http://www.gravatar.com/avatar/4cbc061c24e36092e7f778816082e345" alt="Gravatar of Andrés Gasson " title="Gravatar of Andrés Gasson" />
	</span>
        <p>I'm a network geek, who loves programming. My favourite languages are Clojure & Python, and I especially like the reactor pattern paradigm hwihc makes me ¡Twisted!.</p>
</section>

<section>
  <h1>About Me</h1>
  <p>I'm Twisted¡!.</p>
</section>
<section>
  <h1>Tag Cloud</h1>
    <span id="tag-cloud"><a href='/categories/acls' style='font-size: 110.0%'>ACLs(1)</a> <a href='/categories/atm' style='font-size: 110.0%'>ATM(1)</a> <a href='/categories/bgp' style='font-size: 110.0%'>BGP(1)</a> <a href='/categories/ccie' style='font-size: 160.0%'>CCIE(6)</a> <a href='/categories/ipv6' style='font-size: 110.0%'>IPv6(1)</a> <a href='/categories/l2' style='font-size: 110.0%'>L2(1)</a> <a href='/categories/msdp' style='font-size: 110.0%'>MSDP(1)</a> <a href='/categories/multicast' style='font-size: 110.0%'>Multicast(1)</a> <a href='/categories/networking' style='font-size: 140.0%'>Networking(4)</a> <a href='/categories/pim' style='font-size: 110.0%'>PIM(1)</a> <a href='/categories/pos' style='font-size: 110.0%'>POS(1)</a> <a href='/categories/security' style='font-size: 110.0%'>Security(1)</a> <a href='/categories/time' style='font-size: 110.0%'>Time(1)</a> </span>
</section>

<section class="googleplus">
  <h1>
    <a href="https://plus.google.com/agasson@red-elvis.net?rel=author">
      <img src="http://www.google.com/images/icons/ui/gprofile_button-32.png" width="32" height="32">
      Google+
    </a>
  </h1>
</section>



  <h1>Latest Tweets</h1>
  <p>Let me know what you think about Red-Elvis, talk and tweet using hashtag #redelvis.</p>
  <ul id="tweets">
    <li class="loading">Status updating...</li>
  </ul>
  <script type="text/javascript">
    $.domReady(function(){
      getTwitterFeed("agasson", 4, false);
    });
  </script>
  <script src="/javascripts/twitter.js" type="text/javascript"> </script>
  
    <a href="http://twitter.com/agasson" class="twitter-follow-button" data-show-count="false">Follow @agasson</a>
  

  <br/><br/>

<section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/2009/01/25/ipv6/">IPv6 Study Notes</a>
      </li>
    
      <li class="post">
        <a href="/2009/01/07/pim/">PIM Study Notes</a>
      </li>
    
      <li class="post">
        <a href="/2008/12/17/acls/">CCIE ACL Study Notes</a>
      </li>
    
      <li class="post">
        <a href="/2008/12/17/bgp/">CCIE BGP Study Notes</a>
      </li>
    
      <li class="post">
        <a href="/2008/12/17/ntp/">NTP</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating...</li>
  </ul>
  
  <a href="https://github.com/frap">@frap</a> on GitHub
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'frap',
            count: 0,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>


  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2013 - Andrés Gasson -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id; js.async = true;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>



  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
