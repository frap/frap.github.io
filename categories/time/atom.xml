<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: Time | Andrés Gasson.]]></title>
  <link href="http://www.red-elvis.net/categories/time/atom.xml" rel="self"/>
  <link href="http://www.red-elvis.net/"/>
  <updated>2013-06-26T17:38:14+12:00</updated>
  <id>http://www.red-elvis.net/</id>
  <author>
    <name><![CDATA[Andrés Gasson]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[NTP]]></title>
    <link href="http://www.red-elvis.net/2008/12/17/ntp/"/>
    <updated>2008-12-17T09:51:00+13:00</updated>
    <id>http://www.red-elvis.net/2008/12/17/ntp</id>
    <content type="html"><![CDATA[<h2>Information</h2>

<p>SNTP: Client-only version of NTP (NTP Server &ndash;> SNTP Client). Can use unicast or broadcast..</p>

<p>NTP: Client and Server, uses UDP port 123. Uses unicast by default (client does a GET) but can also run in broadcast and multicast (224.0.1.1) mode (make sure you enable multicast routing in that case).</p>

<p>Stratum: Indicates the quality of the time source. Lower is better, default is 8. Stratum 1 is normally atomic good&hellip;</p>

<p>Some NTP commands are at the global level, and some at the interface level.</p>

<p>NTP is supposed to be a simple topic but, for some reason it had me pulling a lot of hair out. The best advice I can give is to be patient with updates&hellip;</p>

<h2>Configuration</h2>

<h3>100% Foolproof Config</h3>

<p><strong>Server Side</strong>
From <a href="http://www-tac.cisco.com/Support_Library/Internetworking/NTP/mailarchive/0003.html">Dave Katz in his TAC days</a>&hellip;</p>

<pre><code>R1#clock set 12:00:00 1 jan 2005


R1(config)#clock timezone EST -5


R1(config)#clock summertine EDT recurring


R1(config)#ntp master [stratum]
</code></pre>

<p>To enable NTP server</p>

<!-- more -->


<pre><code>R1(config)#clock-calendar valid
</code></pre>

<p>Tells the router to trust the internal clock (authoritative &ndash; only for platforms with real-time clocks )</p>

<pre><code>R1(config)#ntp authenticate
</code></pre>

<p>To enable NTP authentication on server</p>

<pre><code>R1(config)#ntp trusted-key 1
</code></pre>

<p>To define which key(s) will be accepted.</p>

<pre><code>R1(config)#ntp authentication-key 1 md5 cisco123
</code></pre>

<p>To define key(s) (multiple keys can be defined for migrations, etc.).</p>

<p><strong>Client Side</strong></p>

<pre><code>R2(config)#clock timezone EST -5


R2(config)#clock summertine EDT recurring


R2(config)#ntp server &lt;ip address&gt; [key]
</code></pre>

<p>To enable NTP client and associate with a key.</p>

<pre><code>R2(config)#ntp update-calendar
</code></pre>

<p>(updade the internal RT clock &ndash; only for platforms with real-time clocks)</p>

<pre><code>R2(config)#ntp authentication-key 1 md5 cisco123
</code></pre>

<p>To define key(s) (multiple keys can be defined for migrations, etc.).</p>

<h3>Commands</h3>

<pre><code>R1(config)#ntp master &lt;stratum&gt;
</code></pre>

<p>To enable NTP server.</p>

<pre><code>R1(config-if)#ntp broadcast
</code></pre>

<p>To use broadcast (or multicast *need multicast routing).</p>

<pre><code>R2(config)#ntp server &lt;ip address&gt;
</code></pre>

<p>To enable NTP client (one-way sync) in unicast mode.</p>

<pre><code>R2(config-if)#ntp broadcast client
</code></pre>

<p>To enable NTP client in broadcast mode (or multicast *need multicast routing).</p>

<pre><code>R2(config-if)#ntp disable
</code></pre>

<p>To disable NTP on an interface.</p>

<pre><code>R3(config)#ntp peer &lt;ip address&gt;
</code></pre>

<p>To enable NTP peering (two-way sync).</p>

<pre><code>R3(config)#ntp peer &lt;ip address&gt; prefer
</code></pre>

<p>To define who is better.</p>

<pre><code>R1(config)#ntp access-group [query-only|serve-only|serve|peer] &lt;access-list 1-99&gt;
</code></pre>

<p>To configure NTP Security.</p>

<pre><code>R4(config)#sntp server &lt;ip address&gt;
</code></pre>

<p>To enable/configure SNTP server (unicast mode).</p>

<pre><code>R4(config-if)#sntp broadcast client
</code></pre>

<p>To enable SNTP (broadcast mode).</p>

<h2>Links</h2>

<p>NTP Overview/Architecture
<a href="http://www.cisco.com/univercd/cc/td/doc/product/iaabu/cddm/cddm111/adguide/ntp.htm#xtocid189301">http://www.cisco.com/univercd/cc/td/doc/product/iaabu/cddm/cddm111/adguide/ntp.htm#xtocid189301</a></p>

<p>NTP Configuration
<a href="http://www.cisco.com/univercd/cc/td/doc/product/software/ios122/122cgcr/ffun_c/fcfprt3/fcf012.htm">http://www.cisco.com/univercd/cc/td/doc/product/software/ios122/122cgcr/ffun_c/fcfprt3/fcf012.htm</a></p>

<p>Hardening Cisco Routers &ndash; Chapter 10 &ndash; NTP
<a href="http://www.oreilly.com/catalog/hardcisco/chapter/ch10.html">http://www.oreilly.com/catalog/hardcisco/chapter/ch10.html</a></p>
]]></content>
  </entry>
  
</feed>
